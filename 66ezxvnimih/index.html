<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Printable Hanzi Writer</title>
  <script src="https://unpkg.com/hanzi-writer@3.3.0/dist/hanzi-writer.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
      text-align: center;
    }

    h1 {
      color: #1976d2;
      margin-bottom: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .input-section {
      margin-bottom: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .input-group {
      display: flex;
      width: 100%;
      max-width: 500px;
      gap: 10px;
    }

    input[type="text"] {
      padding: 12px;
      font-size: 16px;
      flex: 1;
      border-radius: 6px;
      border: 1px solid #ccc;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #1976d2;
    }

    button {
      padding: 12px 20px;
      font-size: 16px;
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #135ca6;
    }

    .loading {
      display: none;
      margin: 20px 0;
      color: #666;
    }

    .error {
      color: #d32f2f;
      margin: 10px 0;
      display: none;
    }

    .character-print-block {
      page-break-after: always;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
      padding: 20px;
      background: white;
      border-radius: 8px;
    }

    .character-title {
      font-size: 24px;
      margin-bottom: 10px;
      color: #333;
    }

    .character-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 15px;
      width: 100%;
      margin: 20px 0;
    }

    .stroke-cell {
      width: 100%;
      aspect-ratio: 1/1;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 1px solid #eee;
      border-radius: 4px;
      background: #fafafa;
    }

    .stroke-number {
      position: absolute;
      top: 5px;
      left: 5px;
      background: rgba(0,0,0,0.7);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
    }

    .pinyin {
      font-size: 18px;
      margin: 10px 0;
      color: #666;
    }

    .cell-container {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .print-options {
      margin: 15px 0;
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    @media print {
      .container, .input-section, h1, button, .print-options {
        display: none;
      }
      .character-print-block {
        margin: 0;
        padding: 0;
        page-break-inside: avoid;
      }
    }

    @media (max-width: 600px) {
      .character-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      .input-group {
        flex-direction: column;
      }
    }
  </style>
<meta name="apps-name" content="My Web App"></meta></head>
<body>
  <div class="container">
    <h1>Printable Stroke-by-Stroke Hanzi</h1>
    
    <div class="input-section">
      <div class="input-group">
        <input type="text" id="inputText" placeholder="Enter Chinese characters (e.g. 你好)" value="汉">
        <button onclick="renderCharacters()">Generate</button>
      </div>
      <div class="print-options">
        <button onclick="window.print()">Print</button>
        <button onclick="clearAll()">Clear</button>
      </div>
      <div class="error" id="errorMessage"></div>
    </div>
    
    <div class="loading" id="loadingIndicator">
      Generating stroke order diagrams...
    </div>
    
    <div id="hanziContainer"></div>
  </div>

  <script>
    const pinyinMap = {
      '汉': 'hàn',
      '字': 'zì',
      '学': 'xué',
      '生': 'shēng',
      '国': 'guó',
      '人': 'rén',
      '爱': 'ài',
      '你': 'nǐ',
      '好': 'hǎo',
      '谢': 'xiè',
      '谢': 'xiè',
      '再': 'zài',
      '见': 'jiàn',
      '我': 'wǒ',
      '们': 'men',
      '中': 'zhōng'
    };

    function showError(message) {
      const errorEl = document.getElementById('errorMessage');
      errorEl.textContent = message;
      errorEl.style.display = 'block';
      setTimeout(() => {
        errorEl.style.display = 'none';
      }, 3000);
    }

    function clearAll() {
      document.getElementById('hanziContainer').innerHTML = '';
      document.getElementById('inputText').value = '';
    }

    async function renderCharacters() {
      const container = document.getElementById('hanziContainer');
      const loading = document.getElementById('loadingIndicator');
      container.innerHTML = '';
      
      const input = document.getElementById('inputText').value.trim();
      if (!input) {
        showError('Please enter at least one character');
        return;
      }

      loading.style.display = 'block';
      
      try {
        // Process each character sequentially
        for (const char of input) {
          if (/[\u4e00-\u9fff]/.test(char)) {
            await renderCharacter(char);
          }
        }
      } catch (error) {
        console.error('Error rendering characters:', error);
        showError('An error occurred while generating the characters');
      } finally {
        loading.style.display = 'none';
      }
    }

    async function renderCharacter(char) {
      return new Promise((resolve, reject) => {
        const container = document.getElementById('hanziContainer');
        
        const block = document.createElement('div');
        block.className = 'character-print-block';

        const title = document.createElement('div');
        title.className = 'character-title';
        title.textContent = `Character: ${char}`;
        block.appendChild(title);

        const pinyin = document.createElement('div');
        pinyin.className = 'pinyin';
        pinyin.textContent = pinyinMap[char] || '';
        block.appendChild(pinyin);

        const grid = document.createElement('div');
        grid.className = 'character-grid';
        block.appendChild(grid);
        container.appendChild(block);

        HanziWriter.loadCharacterData(char).then(data => {
          const totalStrokes = data.strokes.length;
          if (totalStrokes === 0) {
            reject(new Error(`No stroke data found for character: ${char}`));
            return;
          }

          for (let i = 1; i <= totalStrokes; i++) {
            const cell = document.createElement('div');
            cell.className = 'stroke-cell';
            
            const cellContainer = document.createElement('div');
            cellContainer.className = 'cell-container';
            cell.appendChild(cellContainer);
            
            const strokeNumber = document.createElement('div');
            strokeNumber.className = 'stroke-number';
            strokeNumber.textContent = i;
            cellContainer.appendChild(strokeNumber);
            
            grid.appendChild(cell);

            const writer = HanziWriter.create(cellContainer, char, {
              width: 100,
              height: 100,
              padding: 5,
              strokeAnimationSpeed: 1,
              delayBetweenStrokes: 100,
              showOutline: true,
              showCharacter: false,
              strokeFadeDuration: 0,
              delayBetweenLoops: 0,
              strokeColor: '#000',
              highlightOnComplete: false,
              radicalColor: null,
            });

            writer.setStrokesVisible(i);
          }
          resolve();
        }).catch(error => {
          console.error(`Error loading character ${char}:`, error);
          reject(error);
        });
      });
    }

    // Initialize with default character
    window.onload = renderCharacters;
  </script>

</body></html>