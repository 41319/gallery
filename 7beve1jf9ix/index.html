<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn to Write Chinese Characters</title>
  <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5.0/dist/hanzi-writer.min.js"></script>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background-color: #fef9e7;
      color: #333;
      text-align: center;
      padding: 20px;
    }
    h1 { color: #ff6f00; }
    h2 { color: #3f51b5; }

    .input-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    input, select, button {
      padding: 12px;
      font-size: 18px;
      border-radius: 8px;
      border: 2px solid #ffd54f;
    }

    input[type="text"] {
      width: 120px;
      text-align: center;
    }

    button {
      background-color: #ffca28;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #ffc107;
    }

    #writer-container {
      margin: 30px auto;
      width: 300px;
      height: 300px;
      background-color: white;
      border: 3px solid #ffd54f;
      border-radius: 15px;
      position: relative;
    }

    #pronounce-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      font-size: 22px;
      background-color: #4dd0e1;
      border-radius: 50%;
      width: 42px;
      height: 42px;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
    }

    .info {
      font-size: 20px;
      margin: 5px;
    }

    #error-message,
    #success-message {
      font-size: 18px;
      display: none;
      margin-top: 10px;
      font-weight: bold;
    }

    #error-message { color: #d32f2f; }
    #success-message { color: #388e3c; }

    #progress-tracker {
      margin-top: 10px;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-5px); }
      40%, 80% { transform: translateX(5px); }
    }

    .shake {
      animation: shake 0.4s ease-in-out;
    }

    #controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
  </style>
<meta name="apps-name" content="My Web App"></meta></head>
<body>
  <h1>‚úèÔ∏è Learn to Write Chinese Characters</h1>
  <p>Choose a character, load it, and start practicing!</p>

  <div class="input-group">
    <input type="text" id="char-input" maxlength="1" placeholder="ËæìÂÖ•Ê±âÂ≠ó">
    <select id="char-select"></select>
    <button onclick="loadCharacter()">üéØ Load Character</button>
  </div>

  <h2>üñåÔ∏è Stroke Order Animation &amp; Practice</h2>

  <div id="writer-container">
    <div id="writer"></div>
    <button id="pronounce-btn" onclick="pronounceCharacter()">üîä</button>
  </div>

  <div class="info" id="pinyin-display">Pinyin: </div>
  <div class="info" id="meaning-display">Meaning: </div>

  <div id="error-message">‚ùå Oops! Try again!</div>
  <div id="success-message">‚úÖ Yay! Perfect strokes!</div>

  <div id="progress-tracker">
    <h3>üìä Progress</h3>
    <div class="info" id="accuracy-display">Accuracy: 0%</div>
    <div class="info" id="streak-display">Perfect Streak: 0</div>
  </div>

  <div id="controls">
    <button onclick="startQuiz()">üìù Practise Writing</button>
    <button onclick="writer.animateCharacter()">‚ñ∂Ô∏è Show Stroke Order</button>
    <button onclick="resetCanvas()">üßΩ</button>
    <button onclick="nextCharacter()">‚û°Ô∏è Next Character</button>
  </div>

  <audio id="error-sound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
  <audio id="success-sound" src="https://www.soundjay.com/button/beep-09.wav"></audio>

  <script>
    let writer;
    let charList = [];
    let activeCharIndex = 0;
    let totalStrokes = 0;
    let correctStrokes = 0;
    let perfectStreak = 0;
    let currentMistakes = 0;

    const dictionary = {
      'Áà±': { pinyin: '√†i', meaning: 'Love' },
      'Â≠¶': { pinyin: 'xu√©', meaning: 'Learn' },
      'Â•Ω': { pinyin: 'h«éo', meaning: 'Good' },
      '‰∏≠': { pinyin: 'zh≈çng', meaning: 'Middle/China' },
      'ÂõΩ': { pinyin: 'gu√≥', meaning: 'Country' },
      '‰∫∫': { pinyin: 'r√©n', meaning: 'Person' },
      'Âæ∑': { pinyin: 'd√©', meaning: 'Virtue' },
      '‰πâ': { pinyin: 'y√¨', meaning: 'Righteousness' },
    };

    function getQueryParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        chars: params.get('chars') || 'Áà±Â≠¶Â•Ω‰∏≠',
        activeChar: parseInt(params.get('activeChar')) || 0
      };
    }

    function populateDropdown() {
      const select = document.getElementById('char-select');
      select.innerHTML = '';
      for (let char of charList) {
        const option = document.createElement('option');
        option.value = char;
        option.textContent = char;
        select.appendChild(option);
      }
    }

    function updateCharInfo(char) {
      const info = dictionary[char];
      document.getElementById('pinyin-display').textContent = `Pinyin: ${info?.pinyin || 'Unknown'}`;
      document.getElementById('meaning-display').textContent = `Meaning: ${info?.meaning || 'Not in dictionary'}`;
    }

    function initWriter(character) {
      document.getElementById('writer').innerHTML = '';
      writer = HanziWriter.create('writer', character, {
        width: 300,
        height: 300,
        padding: 5,
        showOutline: true,
        drawingColor: '#000',
        strokeColor: '#ff7043',
        outlineColor: '#90caf9',
        highlightColor: '#ef5350',
        strokeAnimationSpeed: 1,
        strokeHighlightSpeed: 2,
        delayBetweenStrokes: 500
      });
      startQuiz();
    }

    function loadCharacter() {
      const inputChar = document.getElementById('char-input').value.trim();
      const selectedChar = document.getElementById('char-select').value;
      const char = inputChar || selectedChar || charList[activeCharIndex];

      if (!char || char.length !== 1) return;

      document.getElementById('char-input').value = char;
      document.getElementById('char-select').value = char;

      updateCharInfo(char);
      document.getElementById('error-message').style.display = 'none';
      document.getElementById('success-message').style.display = 'none';
      initWriter(char);
    }

    function startQuiz() {
      currentMistakes = 0;
      writer.quiz({
        onMistake: () => {
          currentMistakes++;
          totalStrokes++;
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('error-sound').play();
          document.getElementById('writer-container').classList.add('shake');
          setTimeout(() => document.getElementById('writer-container').classList.remove('shake'), 400);
          updateProgress();
        },
        onCorrectStroke: () => {
          correctStrokes++;
          totalStrokes++;
          document.getElementById('error-message').style.display = 'none';
          updateProgress();
        },
        onComplete: (summary) => {
          if (summary.totalMistakes === 0) {
            document.getElementById('success-message').style.display = 'block';
            document.getElementById('success-sound').play();
            perfectStreak++;
          } else {
            perfectStreak = 0;
          }
          updateProgress();
        }
      });
    }

    function resetCanvas() {
      writer.hideCharacter();
      writer.showOutline();
      document.getElementById('error-message').style.display = 'none';
      document.getElementById('success-message').style.display = 'none';
    }

    function pronounceCharacter() {
      const char = document.getElementById('char-input').value.trim() || charList[activeCharIndex];
      const utterance = new SpeechSynthesisUtterance(char);
      utterance.lang = 'zh-CN';
      speechSynthesis.speak(utterance);
    }

    function updateProgress() {
      const accuracy = totalStrokes > 0 ? Math.round((correctStrokes / totalStrokes) * 100) : 0;
      document.getElementById('accuracy-display').textContent = `Accuracy: ${accuracy}%`;
      document.getElementById('streak-display').textContent = `Perfect Streak: ${perfectStreak}`;
    }

    function nextCharacter() {
      activeCharIndex = (activeCharIndex + 1) % charList.length;
      document.getElementById('char-input').value = charList[activeCharIndex];
      loadCharacter();
    }

    window.onload = () => {
      const { chars, activeChar } = getQueryParams();
      charList = chars.split('');
      activeCharIndex = activeChar < charList.length ? activeChar : 0;
      populateDropdown();
      document.getElementById('char-input').value = charList[activeCharIndex];
      loadCharacter();
    };
  </script>


</body></html>